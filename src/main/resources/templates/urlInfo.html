<!DOCTYPE HTML>
<html lang="it" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title>ED - Url Checker</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <link rel='stylesheet' href="https://cdn.jsdelivr.net/npm/bulma@0.9.3/css/bulma.min.css">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
  <link rel="stylesheet" type="text/css" media="all" th:href="@{/css/style.css}"/>
</head>
<body style="background-color: #FFFF;">
<div th:insert="navbar :: navbar"></div>
<div class="container vh-100">
  <div class="row" style="padding-top: 5%;">
    <div class="col-md-12 mx-auto">
      <h3 class="display-2 fw-italic text-center text-primary">ANALISI DELL'URL</h3>
    </div>
  </div>

  <!-- pie chart -->
  <div class="row text-center">
    <div class="col-md-6 mx-auto">
      <div th:if="${urlDTO.getVotes().getHarmless() != 0} or ${urlDTO.getVotes().getMalicious() != 0}">
        <div class="card">
          <div class="card-body">
            <h5 class="card-title"><span>Analisi dei principali anti-malware</span></h5>
            <div class="chart">
              <canvas id="canvas"></canvas>
              <span th:text="${urlDTO.getVotes().getMalicious()}" th:value="${urlDTO.getVotes().getMalicious()}" id="malicious-level"
                    style="display: none;"/>
              <span th:text="${urlDTO.getVotes().getHarmless()}" th:value="${urlDTO.getVotes().getHarmless()}" id="harmless-level" style="display: none;"/>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- distribuzioni -->
  <div class="row text-center" style="padding-top: 5%;">
    <div class="col-md-6 mx-auto">
      <div class="accordion" id="accordionContainerDistributions">
        <div class="accordion-item">
          <h2 class="accordion-header" id="distHeading">
            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                    aria-expanded="false"
                    data-bs-target="#distCollapse" aria-controls="distCollapse">Distribuzioni
            </button>
          </h2>
          <div id="distCollapse" aria-labelledby="distHeading" class="accordion-collapse collapse"
               data-bs-parent="#accordionContainerDistributions">
            <div class="accordion-body" th:if="${urlDTO.getFilenameDistributions()}">
              <ul class="list-group" th:each="dist: ${urlDTO.getFilenameDistributions()}">
                <li class="list-group-item"><span th:text="${dist}"></span></li>
              </ul>
            </div>
            <div class="accordion-body" th:if="${urlDTO.getFilenameDistributions() == null}">
              <span style="color: red;"> Siamo spiacenti, non sono presenti distribuzioni per questo dominio inserito.</span>

            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- tags -->
  <div class="row text-center" style="padding-top: 5%;">
    <div class="col-md-6 mx-auto">
      <div class="accordion" id="accordionContainerTags">
        <div class="accordion-item">
          <h2 class="accordion-header" id="tagHeading">
            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                    aria-expanded="false"
                    data-bs-target="#tagCollapse" aria-controls="tagCollapse">Tags
            </button>
          </h2>
          <div id="tagCollapse" aria-labelledby="tagHeading" class="accordion-collapse collapse"
               data-bs-parent="#accordionContainerTags">
            <div class="accordion-body" th:if="${!urlDTO.getTags().isEmpty()}">
              <ul class="list-group" th:each="tag: ${urlDTO.getTags()}">
                <li class="list-group-item"><span th:text="${tag}"></span></li>
              </ul>
            </div>
            <div class="accordion-body" th:unless="${!urlDTO.getTags().isEmpty()}">
              <span style="color: red;"> Siamo spiacenti, non sono presenti tags per questo dominio inserito.</span>

            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <!-- bar chart -->
  <div class="row text-center" style="padding-top: 5%;">
    <div class="col-md-6 mx-auto">
      <div class="card">
        <div class="card-body">
          <h5 class="card-title"><span>Statistiche</span></h5>
          <div class="chart">
            <canvas id="canvasStatsUrl"></canvas>
            <span th:text="${urlDTO.getAnalysisStats().getHarmless()}" id="harmless-stat" style="display: none;"/>
            <span th:text="${urlDTO.getAnalysisStats().getTypeUnsupported()}" id="type-unsupported-stat" style="display: none;"/>
            <span th:text="${urlDTO.getAnalysisStats().getSuspicious()}" id="suspicious-stat" style="display: none;"/>
            <span th:text="${urlDTO.getAnalysisStats().getConfirmedTimeout()}" id="confirmed-timeout-stat" style="display: none;"/>
            <span th:text="${urlDTO.getAnalysisStats().getTimeout()}" id="timeout-stat" style="display: none;"/>
            <span th:text="${urlDTO.getAnalysisStats().getFailure()}" id="failure-stat" style="display: none;"/>
            <span th:text="${urlDTO.getAnalysisStats().getMalicious()}" id="malicious-stat" style="display: none;"/>
            <span th:text="${urlDTO.getAnalysisStats().getUndetected()}" id="undetected-stat" style="display: none;"/>
          </div>
        </div>
      </div>
    </div>
  </div>





</div>
<script th:src="@{/js/urlScript.js}"></script>
</body>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js" integrity="sha384-3ceskX3iaEnIogmQchP8opvBy3Mi7Ce34nWjpBIwVTHfGYWQS9jwHDVRnpKKHJg7" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.js" integrity="sha384-hjtEWSfxVipaKknyGUhJZbhSbbepyHXBQlM78R56XnihJKl1YPeepRjUWc3aMMHH" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
        crossorigin="anonymous"></script>
<script type="text/javascript" th:src="@{/js/urlScript.js}"></script>
<script>
    const items = document.querySelectorAll('.nav-link');
    items.forEach(navItem => {
      navItem.classList.remove('active');
    });
    document.querySelector('#navItemUrl').classList.add('active');
  </script>
</html>